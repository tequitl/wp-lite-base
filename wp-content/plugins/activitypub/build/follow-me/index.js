(()=>{var e,t={20:(e,t,r)=>{"use strict";var o=r(609),n=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,r){var o,i={},c=null,u=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,o)&&!l.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:n,type:e,key:c,ref:u,props:i,_owner:s.current}}},609:e=>{"use strict";e.exports=window.React},612:(e,t,r)=>{"use strict";const o=window.wp.blocks,n=window.wp.primitives;var a=r(848);const s=(0,a.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(n.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})});var l=r(609),i=r(942),c=r.n(i);const u=window.wp.blockEditor,p=window.wp.i18n,d={html:!1,color:{gradients:!0,link:!0,__experimentalDefaultControls:{background:!0,text:!0,link:!0}},__experimentalBorder:{radius:!0,width:!0,color:!0,style:!0},typography:{fontSize:!0,__experimentalDefaultControls:{fontSize:!0}}},f=d;function v({buttonOnly:e=!1,className:t="",...r}){return r.className=c()(t,e?"is-style-button-only":"is-style-default"),r}const b={attributes:{buttonOnly:{type:"boolean",default:!1},buttonText:{type:"string",default:"Follow"},selectedUser:{type:"string",default:"blog"}},supports:d,isEligible:({buttonText:e,buttonOnly:t})=>!!e||!!t,migrate({buttonText:e,...t}){const r=(0,o.createBlock)("core/button",{text:e});return[v(t),[r]]}},m={attributes:{selectedUser:{type:"string",default:"blog"},buttonOnly:{type:"boolean",default:!1}},supports:f,isEligible:({buttonOnly:e})=>!!e,migrate:v,save(){const e=u.useBlockProps.save(),t=u.useInnerBlocksProps.save(e);return(0,l.createElement)("div",{...t})}},y=[{attributes:{selectedUser:{type:"string",default:"blog"}},supports:f,isEligible:(e,t)=>1===t.length&&"button"===t[0].attributes.tagName,migrate(e,t){var r;const{tagName:n,...a}=t[0].attributes,s=null!==(r=t[0].originalContent.replace(/<[^>]*>/g,""))&&void 0!==r?r:(0,p.__)("Follow","activitypub");return[e,[(0,o.createBlock)("core/button",{...a,text:s})]]},save(){const e=u.useBlockProps.save(),t=u.useInnerBlocksProps.save(e);return(0,l.createElement)("div",{...t})}},m,b],w=window.wp.apiFetch;var h=r.n(w);const g=window.wp.data,_=window.wp.coreData,E=window.wp.components,k=window.wp.element;function x(){return window._activityPubOptions||{}}function O({name:e}){const{enabled:t}=x(),r=t?.blog?"":(0,p.__)("It will be empty in other non-author contexts.","activitypub"),o=(0,p.sprintf)(/* translators: %1$s: block name, %2$s: extra information for non-author context */ /* translators: %1$s: block name, %2$s: extra information for non-author context */
(0,p.__)("This <strong>%1$s</strong> block will adapt to the page it is on, displaying the user profile associated with a post author (in a loop) or a user archive. %2$s","activitypub"),e,r).trim();return(0,l.createElement)(E.Card,null,(0,l.createElement)(E.CardBody,null,(0,k.createInterpolateElement)(o,{strong:(0,l.createElement)("strong",null)})))}const S={avatar:"https://secure.gravatar.com/avatar/default?s=120",webfinger:"@well@hello.dolly",name:(0,p.__)("Hello Dolly Fan Account","activitypub"),url:"#",image:{url:""},summary:""};function B(e){if(!e)return S;const t={...S,...e};return t.avatar=t?.icon?.url,t.webfinger&&!t.webfinger.startsWith("@")&&(t.webfinger="@"+t.webfinger),t}function N({profile:e,className:t,innerBlocksProps:r}){const{webfinger:o,avatar:n,name:a,image:s,summary:i,followersCount:c,postsCount:u}=e,d=t&&t.includes("is-style-button-only"),f={posts:u||0,followers:c||0};return(0,l.createElement)("div",{className:"activitypub-profile"},!d&&s?.url&&(0,l.createElement)("div",{className:"activitypub-profile__header",style:{backgroundImage:`url(${s.url})`}}),(0,l.createElement)("div",{className:"activitypub-profile__body"},!d&&(0,l.createElement)("img",{className:"activitypub-profile__avatar",src:n,alt:a}),(0,l.createElement)("div",{className:"activitypub-profile__content"},!d&&(0,l.createElement)("div",{className:"activitypub-profile__info"},(0,l.createElement)("div",{className:"activitypub-profile__name"},a),(0,l.createElement)("div",{className:"activitypub-profile__handle"},o)),(0,l.createElement)("div",{...r}),!d&&(0,l.createElement)("div",{className:"activitypub-profile__bio",dangerouslySetInnerHTML:{__html:i}}),!d&&(0,l.createElement)("div",{className:"activitypub-profile__stats"},Object.entries(f).map((([e,t])=>(0,l.createElement)("div",{key:e},(0,l.createElement)("strong",null,t)," ","posts"===e?(0,p._n)("post","posts",t,"activitypub"):"followers"===e?(0,p._n)("follower","followers",t,"activitypub"):(0,p._n)("following","following",t,"activitypub"))))))))}const P=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","name":"activitypub/follow-me","apiVersion":3,"version":"2.2.0","title":"Follow me on the Fediverse","category":"widgets","description":"Display your Fediverse profile so that visitors can follow you.","textdomain":"activitypub","icon":"groups","example":{"attributes":{"className":"is-style-default"}},"supports":{"html":false,"interactivity":true,"color":{"gradients":true,"link":true,"__experimentalDefaultControls":{"background":true,"text":true,"link":true}},"__experimentalBorder":{"radius":true,"width":true,"color":true,"style":true},"shadow":true,"typography":{"fontSize":true,"__experimentalDefaultControls":{"fontSize":true}},"innerBlocks":{"allowedBlocks":["core/button"]}},"styles":[{"name":"default","label":"Default","isDefault":true},{"name":"button-only","label":"Button"},{"name":"profile","label":"Profile"}],"attributes":{"selectedUser":{"type":"string","default":"blog"}},"usesContext":["postType","postId"],"editorScript":"file:./index.js","viewScriptModule":"file:./view.js","viewScript":"wp-api-fetch","style":"file:./style-index.css","render":"file:./render.php"}');(0,o.registerBlockType)(P,{deprecated:y,edit:function({attributes:e,setAttributes:t,context:{postType:r,postId:o}}){const n=(0,u.useBlockProps)({className:"activitypub-follow-me-block-wrapper"}),a=function({withInherit:e=!1}){const{enabled:t,namespace:r}=x(),[o,n]=(0,k.useState)(!1),{fetchedUsers:a,isLoadingUsers:s}=(0,g.useSelect)((e=>{const{getUsers:r,getIsResolving:o}=e("core");return{fetchedUsers:t?.users?r({capabilities:"activitypub"}):null,isLoadingUsers:!!t?.users&&o("getUsers",[{capabilities:"activitypub"}])}}),[]),l=(0,g.useSelect)((e=>a||s?null:e("core").getCurrentUser()),[a,s]);(0,k.useEffect)((()=>{a||s||!l||h()({path:`/${r}/actors/${l.id}`,method:"HEAD",headers:{Accept:"application/activity+json"},parse:!1}).then((()=>n(!0))).catch((()=>n(!1)))}),[a,s,l]);const i=a||(l&&o?[{id:l.id,name:l.name}]:[]);return(0,k.useMemo)((()=>{if(!i.length)return[];const r=[];return t?.blog&&a&&r.push({label:(0,p.__)("Blog","activitypub"),value:"blog"}),e&&t?.users&&a&&r.push({label:(0,p.__)("Dynamic User","activitypub"),value:"inherit"}),i.reduce(((e,t)=>(e.push({label:t.name,value:`${t.id}`}),e)),r)}),[i])}({withInherit:!0}),{selectedUser:s,className:i="is-style-default"}=e,c="inherit"===s,[d,f]=(0,k.useState)(B(S)),v="blog"===s?0:s,b=[["core/button",{text:(0,p.__)("Follow","activitypub")}]],m=(0,u.useInnerBlocksProps)({},{allowedBlocks:["core/button"],template:b,templateLock:!1,renderAppender:!1}),y=(0,g.useSelect)((e=>{const{getEditedEntityRecord:t}=e(_.store),n=t("postType",r,o)?.author;return null!=n?n:null}),[r,o]);return(0,k.useEffect)((()=>{if(c&&!y)return;const e=c?y:v;(function(e){const{namespace:t}=x(),r={headers:{Accept:"application/activity+json"},path:`/${t}/actors/${e}`};return h()(r)})(e).then((t=>{if(f(B(t)),t.followers)try{const{pathname:e}=new URL(t.followers);h()({path:e.replace("wp-json/","")}).then((({totalItems:e=0})=>{f((t=>({...t,followersCount:e})))})).catch((()=>{}))}catch(e){}e?h()({path:`/wp/v2/users/${e}/?context=activitypub`}).then((({post_count:e})=>{f((t=>({...t,postsCount:e})))})).catch((()=>{})):h()({path:"/wp/v2/posts",method:"HEAD",parse:!1}).then((e=>{const t=e.headers.get("X-WP-Total");f((e=>({...e,postsCount:t})))})).catch((()=>{}))})).catch((()=>{}))}),[v,y,c]),(0,k.useEffect)((()=>{a.length&&(a.find((({value:e})=>e===s))||t({selectedUser:a[0].value}))}),[s,a]),(0,l.createElement)("div",{...n},(0,l.createElement)(u.InspectorControls,{key:"activitypub-follow-me"},a.length>1&&(0,l.createElement)(E.PanelBody,{title:(0,p.__)("Follow Me Options","activitypub")},(0,l.createElement)(E.SelectControl,{label:(0,p.__)("Select User","activitypub"),value:e.selectedUser,options:a,onChange:e=>t({selectedUser:e}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))),c&&!y?(0,l.createElement)(O,{name:(0,p.__)("Follow Me","activitypub")}):(0,l.createElement)(N,{profile:d,className:i,innerBlocksProps:m}))},icon:s,save:function(){const e=u.useBlockProps.save(),t=u.useInnerBlocksProps.save(e);return(0,l.createElement)("div",{...t})}})},848:(e,t,r)=>{"use strict";e.exports=r(20)},942:(e,t)=>{var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=s(e,a(r)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)o.call(e,r)&&e[r]&&(t=s(t,r));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,r,n,a)=>{if(!r){var s=1/0;for(u=0;u<e.length;u++){for(var[r,n,a]=e[u],l=!0,i=0;i<r.length;i++)(!1&a||s>=a)&&Object.keys(o.O).every((e=>o.O[e](r[i])))?r.splice(i--,1):(l=!1,a<s&&(s=a));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,n,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={338:0,870:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,a,[s,l,i]=r,c=0;if(s.some((t=>0!==e[t]))){for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(i)var u=i(o)}for(t&&t(r);c<s.length;c++)a=s[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},r=globalThis.webpackChunkwordpress_activitypub=globalThis.webpackChunkwordpress_activitypub||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=o.O(void 0,[870],(()=>o(612)));n=o.O(n)})();